extends Actor

# ------------------------------------------------------------------------------
# Signals
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Constants and ENUMs
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Export Variables
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Variables
# ------------------------------------------------------------------------------
var _fov : Array[Vector2i] = []

# ------------------------------------------------------------------------------
# Onready Variables
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Setters / Getters
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Override Methods
# ------------------------------------------------------------------------------
func _physics_process(_delta: float) -> void:
	if map == null: return
	if _fov.size() <= 0:
		_UpdateFOV()
	var actors : Array[Actor] = map.get_actors_in_region(_fov)
	for actor : Actor in actors:
		if actor.is_in_group(&"Player"):
			print("I see you, PLAYER!")

# ------------------------------------------------------------------------------
# Private Methods
# ------------------------------------------------------------------------------
func _UpdateFOV() -> void:
	var smap : Shadowmap = Shadowmap.Get().get_ref()
	var q : ShadowQuadrent = ShadowQuadrent.new(
		map.local_to_map(global_position),
		ShadowQuadrent.Cardinal.EAST
	)
	_fov = smap.compute_fov(q, 3)
	map.highlight_region(name, _fov, 3)

# ------------------------------------------------------------------------------
# Public Methods
# ------------------------------------------------------------------------------


# ------------------------------------------------------------------------------
# Handler Methods
# ------------------------------------------------------------------------------



